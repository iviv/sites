<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DKIM Signature Validator</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/dkimvalidator.css">
</head>
<body>
    <!-- Theme Selector Bar -->
    <div class="theme-selector">
        <div class="theme-group">
            <span class="theme-group-label">Dark</span>
            <button class="theme-btn active" data-theme="dark-cyber" onclick="setTheme('dark-cyber')" title="Cyber Green"></button>
            <button class="theme-btn" data-theme="dark-dracula" onclick="setTheme('dark-dracula')" title="Dracula"></button>
            <button class="theme-btn" data-theme="dark-nord" onclick="setTheme('dark-nord')" title="Nord"></button>
            <button class="theme-btn" data-theme="dark-monokai" onclick="setTheme('dark-monokai')" title="Monokai"></button>
            <button class="theme-btn" data-theme="dark-ocean" onclick="setTheme('dark-ocean')" title="Ocean"></button>
        </div>
        <div class="theme-group">
            <span class="theme-group-label">Light</span>
            <button class="theme-btn" data-theme="light-classic" onclick="setTheme('light-classic')" title="Classic"></button>
            <button class="theme-btn" data-theme="light-solarized" onclick="setTheme('light-solarized')" title="Solarized"></button>
            <button class="theme-btn" data-theme="light-github" onclick="setTheme('light-github')" title="GitHub"></button>
            <button class="theme-btn" data-theme="light-rose" onclick="setTheme('light-rose')" title="Rose"></button>
            <button class="theme-btn" data-theme="light-mint" onclick="setTheme('light-mint')" title="Mint"></button>
        </div>
    </div>

    <div class="tooltip" id="tooltip">
        <div class="tooltip-title" id="tooltipTitle"></div>
        <div class="tooltip-desc" id="tooltipDesc"></div>
        <div class="tooltip-value" id="tooltipValue"></div>
    </div>

    <div class="toast" id="toast"><span>&#x2713;</span><span id="toastMsg">Copied!</span></div>

    <!-- Help Modal -->
    <div class="modal-overlay" id="helpModal" onclick="if(event.target===this)closeHelp()">
        <div class="modal">
            <div class="modal-header">
                <span class="modal-title">&#x1F4DA; Email Authentication Guide</span>
                <button class="modal-close" onclick="closeHelp()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="help-section">
                    <h3>&#x1F510; DKIM (DomainKeys Identified Mail)</h3>
                    <p>DKIM allows senders to cryptographically sign emails, proving the message hasn't been altered in transit. The receiving server fetches the sender's public key from DNS and verifies the signature.</p>
                    <ul class="help-list">
                        <li>Protects against email tampering</li>
                        <li>Verifies the sending domain's identity</li>
                        <li>Uses RSA or Ed25519 cryptographic signatures</li>
                    </ul>
                    <p><a href="https://datatracker.ietf.org/doc/html/rfc6376" target="_blank">RFC 6376 - DKIM Signatures</a></p>
                </div>

                <div class="help-section">
                    <h3>&#x1F6E1;&#xFE0F; SPF (Sender Policy Framework)</h3>
                    <p>SPF allows domain owners to specify which mail servers are authorized to send email on their behalf. Receivers check if the sending IP is listed in the domain's SPF record.</p>
                    <ul class="help-list">
                        <li>Prevents unauthorized servers from sending as your domain</li>
                        <li>Uses DNS TXT records to publish authorized IPs</li>
                        <li>Results: pass, fail, softfail, neutral, none</li>
                    </ul>
                    <p><a href="https://datatracker.ietf.org/doc/html/rfc7208" target="_blank">RFC 7208 - SPF</a></p>
                </div>

                <div class="help-section">
                    <h3>&#x1F4CB; DMARC (Domain-based Message Authentication)</h3>
                    <p>DMARC builds on DKIM and SPF, telling receivers what to do when authentication fails. It also enables reporting so domain owners can monitor abuse.</p>
                    <ul class="help-list">
                        <li>Policies: none (monitor), quarantine (spam), reject</li>
                        <li>Requires alignment between From domain and DKIM/SPF domains</li>
                        <li>Enables aggregate and forensic reporting</li>
                    </ul>
                    <p><a href="https://datatracker.ietf.org/doc/html/rfc7489" target="_blank">RFC 7489 - DMARC</a></p>
                </div>

                <div class="help-section">
                    <h3>&#x1F517; ARC (Authenticated Received Chain)</h3>
                    <p>ARC preserves email authentication results when messages are forwarded through mailing lists or other intermediaries that may break DKIM signatures.</p>
                    <ul class="help-list">
                        <li>Each intermediary adds a signed ARC set</li>
                        <li>Chain validation shows if previous hops verified</li>
                        <li>Helps legitimate forwarded mail pass authentication</li>
                    </ul>
                    <p><a href="https://datatracker.ietf.org/doc/html/rfc8617" target="_blank">RFC 8617 - ARC</a></p>
                </div>

                <div class="help-section">
                    <h3>&#x26A0;&#xFE0F; Security Considerations</h3>
                    <ul class="help-list">
                        <li><strong>l= tag:</strong> Limits signed body bytes - unsigned content can be appended</li>
                        <li><strong>x= tag:</strong> Signature expiration - expired signatures should be treated with caution</li>
                        <li><strong>Alignment:</strong> DMARC requires DKIM/SPF domains to match the From header</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <header>
            <button class="help-btn" onclick="openHelp()" title="Help">&#x2753;</button>
            <div class="logo">
                <div class="logo-icon">&#x1F510;</div>
                <div>
                    <h1>DKIM Validator</h1>
                    <p class="subtitle">RFC 6376 Cryptographic Signature Verification</p>
                </div>
            </div>
            <p class="privacy">100% client-side &middot; No data sent to servers &middot; DNS queries only for public key retrieval</p>
        </header>

        <div class="input-section">
            <label class="input-label">&#x1F4E7; Raw Email Headers &amp; Body</label>
            <textarea id="input" placeholder="Paste raw email content here..."></textarea>
            <div class="input-footer">
                <button class="btn" onclick="clearAll()">&#x1F5D1;&#xFE0F; Clear</button>
                <span class="status" id="status"></span>
            </div>
        </div>

        <div class="results" id="results">
            <div id="parsingIssuesEl"></div>
            <div id="headersEl"></div>
            <div class="summary" id="summaryEl"></div>
            <div id="relayEl"></div>
            <div id="spfEl"></div>
            <div id="dmarcEl"></div>
            <div id="bimiEl"></div>
            <div id="mtaStsEl"></div>
            <div id="arcEl"></div>
            <div id="sigsEl"></div>
            <div class="debug" id="debugEl">
                <div class="debug-header" onclick="this.parentElement.classList.toggle('expanded')">
                    <span>&#x1F50D; Debug Log</span>
                    <span class="expand-icon">&#x25BC;</span>
                </div>
                <div class="debug-body">
                    <div class="debug-log" id="debugLog"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/dkimvalidator.js"></script>
</body>
</html>
